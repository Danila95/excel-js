System.register([],(function(t,e){"use strict";return{execute:function(){var t=document.createElement("style");t.textContent='@import"https://fonts.googleapis.com/css?family=Roboto&display=swap";/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button}button::-moz-focus-inner,[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}.excel__header{position:absolute;top:0;right:0;left:0;height:34px;padding:8px 4px 0;display:flex;justify-content:space-between}.excel__header .input{margin:0;padding:2px 7px;min-width:1px;color:#000;border:1px solid transparent;border-radius:2px;height:20px;font-size:18px;line-height:22px;outline:none}.excel__header .input:hover{border:1px solid #c0c0c0}.excel__header .input:focus{border:2px solid #1a73e8}.excel__header .button{height:24px;min-width:24px;padding:3px;text-align:center;position:relative;display:inline-block;color:rgba(0,0,0,.7)}.excel__header .button i{font-size:18px}.excel__header .button:active,.excel__header .button.active{color:red}.excel__header .button:hover{background:#eee;cursor:pointer}.excel__toolbar{position:absolute;left:0;right:0;top:34px;height:40px;border-top:1px solid #c0c0c0;border-bottom:1px solid #c0c0c0;padding:7px 10px;display:flex}.excel__toolbar .button{height:24px;min-width:24px;padding:3px;text-align:center;position:relative;display:inline-block;color:rgba(0,0,0,.7)}.excel__toolbar .button i{font-size:18px}.excel__toolbar .button:active,.excel__toolbar .button.active{color:green}.excel__toolbar .button:hover{background:#eee;cursor:pointer}.excel__formula{position:absolute;left:0;right:0;top:74px;height:24px;display:flex;align-items:center;border-bottom:1px solid #c0c0c0}.excel__formula .info{font-size:18px;font-style:italic;text-align:center;border-right:1px solid #c0c0c0;min-width:40px}.excel__formula .input{padding:4px;font-size:12px;outline:none;width:100%;height:100%;color:#000}.excel__table{position:absolute;left:0;right:0;top:98px;overflow-x:auto;padding-bottom:2px}.excel__table .row{display:flex;flex-direction:row;min-height:20px;height:24px}.excel__table .row-info{position:relative;display:flex;justify-content:center;align-items:center;min-width:40px;height:100%;border:1px solid #c0c0c0;background:#f8f9fa;border-top:none}.excel__table .row-data{display:flex}.excel__table .column{display:flex;position:relative;justify-content:center;align-items:center;background:#f8f9fa;min-width:40px;width:120px;border:1px solid #c0c0c0;border-top:0;border-left:0;height:100%}.excel__table .cell{min-width:40px;padding:5px;width:120px;height:100%;border:1px solid #e2e3e3;border-top:0;border-left:0;color:#111;white-space:nowrap;outline:none}.excel__table .cell.selected{border:none;outline:2px solid #3c74ff;z-index:2}.excel__table .cell.selected-group{background:#e6effd}.excel__table .col-resize,.excel__table .row-resize{position:absolute;bottom:0;right:0;opacity:0;background:#3c74ff;z-index:1000}.excel__table .col-resize:hover,.excel__table .row-resize:hover{opacity:1!important}.excel__table .col-resize{top:0;width:4px}.excel__table .col-resize:hover{cursor:col-resize}.excel__table .row-resize{left:0;height:4px}.excel__table .row-resize:hover{cursor:row-resize}#selectFrame{width:0px;height:0px;line-height:0px;border:1px dotted #5c6a8e;background-color:#6582c9;position:absolute;z-index:100;visibility:hidden;-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=40)";filter:alpha(opacity=40);opacity:.4}.item:hover{border:#183376 1px solid;background:#7f97d4;border-bottom-width:2px;margin-bottom:6px}.itemSelected{border:#183376 1px solid;background:#6582c9;width:100px;height:20px;margin:7px;float:left;text-align:center}.itemSelected:hover{border:#183376 1px solid;background:#7f97d4;border-bottom-width:2px;margin-bottom:6px}.db__header{position:fixed;left:0;right:0;top:0;height:64px;display:flex;align-items:center;justify-content:center;background:#fff;box-shadow:0 2px 5px 2px rgba(60,64,67,.15);z-index:1000}.db__new{margin-top:64px;padding:1.5rem;background:#dadce0}.db__create{width:160px;height:160px;background:#fff;border-radius:4px;border:1px solid #dadce0;display:flex;justify-content:center;align-items:center;font-size:1.5rem;text-decoration:none;color:#000;text-align:center}.db__create:hover{cursor:pointer;color:green;border-color:green}.db__view{max-width:1000px;margin:0 auto}.db__table{padding:1rem}.db__list-header{display:flex;justify-content:space-between;color:#202124;font-weight:500;font-size:16px;margin-bottom:10px;padding:0 12px}.db__list{list-style:none;margin:0;padding:0}.db__record{display:flex;justify-content:space-between;align-items:center;padding:12px 14px 12px 16px;margin-bottom:10px}.db__record:hover{background:#e6f4ea;border-radius:25px}.db__record a{text-decoration:none;cursor:pointer;color:#202124;font-size:14px}.db__record a:hover{text-decoration:underline}*{margin:0;padding:0;box-sizing:border-box}body{font-family:Roboto,sans-serif;font-size:12px}.excel{position:relative;color:#888;height:100%;max-width:100%;font-size:.8rem}\n',document.head.appendChild(t);class e{constructor(t){this.$el="string"==typeof t?document.querySelector(t):t}html(t){return"string"==typeof t?(this.$el.innerHTML=t,this):this.$el.outerHTML.trim()}text(t){return"string"==typeof t?(this.$el.textContent=t,this):"input"===this.$el.tagName.toLowerCase()?this.$el.value.trim():this.$el.textContent.trim()}clear(){return this.html(""),this}on(t,e){this.$el.addEventListener(t,e)}off(t,e){this.$el.removeEventListener(t,e)}find(t){return i(this.$el.querySelector(t))}append(t){return t instanceof e&&(t=t.$el),Element.prototype.append?this.$el.append(t):this.$el.appendChild(t),this}get data(){return this.$el.dataset}closest(t){return i(this.$el.closest(t))}getCoords(){return this.$el.getBoundingClientRect()}findAll(t){return this.$el.querySelectorAll(t)}css(t={}){Object.keys(t).forEach((e=>this.$el.style[e]=t[e]))}id(t){if(t){const t=this.id().split(":");return{row:+t[0],col:+t[1]}}return this.data.id}focus(){return this.$el.focus(),this}addClass(t){return this.$el.classList.add(t),this}removeClass(t){return this.$el.classList.remove(t),this}}function i(t){return new e(t)}i.create=(t,e="")=>{const o=document.createElement(t);return e&&o.classList.add(e),i(o)};class o{constructor(){this.listeners={}}emit(t,...e){return!!Array.isArray(this.listeners[t])&&(this.listeners[t].forEach((t=>{t(...e)})),!0)}subscribe(t,e){return this.listeners[t]=this.listeners[t]||[],this.listeners[t].push(e),()=>{this.listeners[t]=this.listeners[t].filter((t=>t!==e))}}}function n(t,e){return t>e&&([e,t]=[t,e]),new Array(e-t+1).fill("").map(((e,i)=>t+i))}class r{constructor(t,e=[]){if(!t)throw new Error("No $root provider for DomListener");this.$root=t,this.listeners=e}initDOMListeners(){this.listeners.forEach((t=>{const e=s(t);if(!this[e]){const t=this.name||"";throw new Error(`Method ${e} is not implemented in ${t} Component`)}this[e]=this[e].bind(this),this.$root.on(t,this[e])}))}removeDOMListeners(){this.listeners.forEach((t=>{const e=s(t);this.$root.off(t,this[e])}))}}function s(t){return"on"+("string"!=typeof(e=t)?"":e.charAt(0).toUpperCase()+e.slice(1));var e}class a extends r{constructor(t,e={}){super(t,e.listeners),this.name=e.name||"",this.emitter=e.emitter,this.unsubscribers=[],this.prepare()}prepare(){}toHTML(){return""}$emit(t,...e){this.emitter.emit(t,...e)}$on(t,e){const i=this.emitter.subscribe(t,e);this.unsubscribers.push(i)}init(){this.initDOMListeners()}destroy(){this.removeDOMListeners(),this.unsubscribers.forEach((t=>t()))}}const l={A:65,Z:90};function c(t){return function(e,i){return`\n        \t<div \n\t\t\t\tclass="cell" \n\t\t\t\tcontenteditable \n\t\t\t\tdata-col="${i}" \n\t\t\t\tdata-type='cell'\n\t\t\t\tdata-id="${t}:${i}"\n\t\t\t></div>\n    \t`}}function d(t,e){return`\n        <div class="column" data-type="resizable" data-col="${e}">\n            ${t}\n            <div class="col-resize" data-resize="col"></div>\n        </div>\n    `}function p(t,e){return`\n        <div class="row" data-type="resizable" data-row="${t}">\n            <div class="row-info">\n                ${t||""}\n                ${t?'<div class="row-resize" data-resize="row"></div>':""}\n            </div>\n            <div class="row-data">${e}</div>\n        </div>\n    `}function u(t,e){return String.fromCharCode(l.A+e)}class h{static className="selected";static classNameGroup="selected-group";constructor(){this.group=[],this.current=null}select(t){this.clear(),t.focus().addClass(h.className),this.group.push(t),this.current=t}clear(){this.group.forEach((t=>t.removeClass(h.className))),this.group.forEach((t=>t.removeClass(h.classNameGroup))),this.group=[]}selectGroup(t=[]){this.clear(),this.group=t,this.group.forEach((t=>t.addClass(h.classNameGroup)))}}new class{constructor(t,e){this.$el=i(t),this.components=e.components||[],this.emitter=new o}getRoot(){const t=i.create("div","excel"),e={emitter:this.emitter};return this.components=this.components.map((o=>{const n=i.create("div",o.className),r=new o(n,e);return n.html(r.toHTML()),t.append(n),r})),t}render(){this.$el.append(this.getRoot()),this.components.forEach((t=>t.init()))}destroy(){this.components.forEach((t=>t.destroy()))}}("#app",{components:[class extends a{static className="excel__header";constructor(t,e){super(t,{name:"Header",listeners:[],...e})}toHTML(){return'\n\t\t\t<input type="text" class="input" value="Новая таблица" />\n\t\n\t\t\t<div>\n\t\n\t\t\t<div class="button">\n\t\t\t\t<i class="material-icons">delete</i>\n\t\t\t</div>\n\t\n\t\t\t<div class="button">\n\t\t\t\t<i class="material-icons">exit_to_app</i>\n\t\t\t</div>\n\t\n\t\t\t</div>\n\t  \t'}},class extends a{static className="excel__toolbar";constructor(t,e){super(t,{name:"Toolbar",listeners:[],...e})}toHTML(){return'\n\t\t\t<div class="button">\n\t\t\t\t<i class="material-icons">format_align_left</i>\n\t\t\t\t</div>\n\t\t\n\t\t\t\t<div class="button">\n\t\t\t\t<i class="material-icons">format_align_center</i>\n\t\t\t\t</div>\n\t\t\n\t\t\t\t<div class="button">\n\t\t\t\t<i class="material-icons">format_align_right</i>\n\t\t\t\t</div>\n\t\t\n\t\t\t\t<div class="button">\n\t\t\t\t<i class="material-icons">format_bold</i>\n\t\t\t\t</div>\n\t\t\n\t\t\t\t<div class="button">\n\t\t\t\t<i class="material-icons">format_italic</i>\n\t\t\t\t</div>\n\t\t\n\t\t\t\t<div class="button">\n\t\t\t\t<i class="material-icons">format_underlined</i>\n\t\t\t</div>\n\t\t'}},class extends a{static className="excel__formula";constructor(t,e){super(t,{name:"Formula",listeners:["input","keydown"],...e})}toHTML(){return'\n\t\t\t<div class="info">fx</div>\n\t\t\t<div id="formula" class="input" contenteditable spellcheck="false"></div>\n\t\t'}init(){super.init(),this.$formula=this.$root.find("#formula"),this.$on("table:select",(t=>{this.$formula.text(t.text())})),this.$on("table:input",(t=>{this.$formula.text(t.text())}))}onInput(t){this.$emit("formula:input",i(t.target).text())}onKeydown(t){if(["Enter","Tab"].includes(t.key)){t.preventDefault();const e=t.target.textContent.trim();this.$emit("formula:done",e)}}},class extends a{static className="excel__table";constructor(t,e){super(t,{name:"Table",listeners:["mousedown","keydown","input"],...e})}toHTML(){return function(t=34){const e=l.Z-l.A+1,i=[],o=new Array(e).fill("").map(u).map(d).join("");i.push(p(null,o));for(let n=0;n<t;n++){const t=new Array(e).fill("").map(c(n)).join("");i.push(p(n+1,t))}return i.join("")}(34)}prepare(){this.selection=new h}init(){super.init(),this.selectCell(this.$root.find('[data-id="0:0"]')),this.$on("formula:input",(t=>{this.selection.current.text(t)})),this.$on("formula:done",(t=>{this.selection.current.focus()}))}selectCell(t){this.selection.select(t),this.$emit("table:select",t)}onMousedown(t){if(function(t){return t.target.dataset.resize}(t))!function(t,e){const o=i(e.target),n=o.closest('[data-type="resizable"]'),r=n.getCoords(),s=o.data.resize,a="col"===s?"bottom":"right";let l;o.css({opacity:1,[a]:"-5000px"}),document.onmousemove=t=>{if("col"===s){const e=t.pageX-r.right;l=r.width+e,o.css({right:-e+"px"})}else{const e=t.pageY-r.bottom;l=r.height+e,o.css({bottom:-e+"px"})}},document.onmouseup=e=>{document.onmousemove=null,document.onmouseup=null,"col"===s?(n.css({width:l+"px"}),t.findAll(`[data-col="${n.data.col}"]`).forEach((t=>{t.style.width=l+"px"}))):n.css({height:l+"px"}),o.css({opacity:0,right:0,bottom:0})}}(this.$root,t);else if(function(t){return"cell"===t.target.dataset.type}(t)){const e=i(t.target);if(t.shiftKey){const t=function(t,e){const i=t.id(!0),o=e.id(!0),r=n(o.col,i.col),s=n(o.row,i.row);return r.reduce(((t,e)=>(s.forEach((i=>t.push(`${i}:${e}`))),t)),[])}(e,this.selection.current).map((t=>this.$root.find(`[data-id='${t}']`)));this.selection.selectGroup(t)}else this.selection.select(e)}}onKeydown(t){const{key:e}=t;if(["Enter","Tab","ArrowLeft","ArrowRight","ArrowDown","ArrowUp"].includes(e)&&!t.shiftKey){t.preventDefault();const i=this.selection.current.id(!0),o=this.$root.find(function(t,{col:e,row:i}){switch(t){case"Enter":case"ArrowDown":i++;break;case"Tab":case"ArrowRight":e++;break;case"ArrowLeft":e=e-1<0?0:e-1;break;case"ArrowUp":i=i-1<0?0:i-1}return`[data-id="${i}:${e}"]`}(e,i));this.selectCell(o)}}onInput(t){this.$emit("table:input",i(t.target))}}]}).render()}}}));
